import{_ as g}from"./AuthenticatedLayout-8214144f.js";import{_ as I,a as V}from"./TextInput-b3b4edbd.js";import{S as w}from"./Select2Input-03e63d7d.js";import{_ as k}from"./PrimaryButton-c6f683ae.js";import{Z as q,k as m,o as f,c as h,a as o,w as c,F as D,b as _,t as u,d as e,f as C,l as A,n as F}from"./app-dae928ff.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";const P={props:{mustVerifyEmail:Boolean,status:String,products:Object,sr:Array,saleInvoice:Object},components:{AuthenticatedLayout:g,InputLabel:I,TextInput:V,Select2Input:w,Head:q,PrimaryButton:k},data(){return{formData:{vendor_id:"",product_id:"",service_charges:"",total_quantity:"",net_amount:"",gross_amount:"",total_discount:"",net_amount:"",total_items:"",total:"",remaining_stock:"",submit_button:"",received_amount:"",total:"",addedItems:[]},addedItems:[],isAmountLess:!1}},created(){this.addedItems=[],this.saleInvoice.sale_invoice_detail.forEach(l=>{this.addedItems.push({index:this.addedItems.length,productId:l.product.id,productName:l.product.name,quantity:l.quantity,amount:l.amount})})},methods:{handleButtonClick(l){this.formData.submit_button=l},submitForm(){this.formData.received_amount>=this.formData.total?(this.formData.addedItems=this.addedItems,this.$inertia.post(route("saleinvoices.store"),this.formData,{onSuccess:()=>{this.$inertia.visit(route("saleinvoices.create"))}})):this.isAmountLess=!0},getProductDetails(l){const t=this.products.find(r=>r.id===parseInt(l));t?(this.formData.product_id=t.id,this.formData.product_code=t.id,this.formData.sale_rate=t.sale_rate,this.formData.expiry_date=t.expiry_date,this.formData.expiry_alert_days=t.expiry_alert_days,this.formData.remaining_stock=t.remaining_stock):(this.formData.product_id="",this.formData.product_code="",this.formData.sale_rate="",this.formData.expiry_alert_days="",this.formData.expiry_date="")},calculateNetAmount(){this.formData.total=parseFloat(this.formData.net_amount)+parseFloat(this.formData.service_charges)},calculateTotalDiscount(){this.formData.total=parseFloat(this.formData.total)-parseFloat(this.formData.total_discount)},receivedAndBalance(){this.formData.remaining_balance=(parseFloat(this.formData.total)-parseFloat(this.formData.received_amount)).toFixed(2)},quantityWisePrice(){const l=this.formData.quantity;this.formData.total_rate=(l*this.formData.sale_rate).toFixed(2)},editItem(l){const t=this.addedItems[l];console.log(t),this.formData.product_code=t.id,this.formData.product_id=t.id,this.formData.quantity=t.quantity,this.formData.sale_rate=t.sale_rate,this.formData.total_rate=t.total_rate,this.formData.expiry_date=t.expiry_date,this.formData.expiry_alert_days=t.expiry_alert_days},addItem(){this.addedItems.push({product_code:this.formData.product_code,product_name:this.getProductById(this.formData.product_id),quantity:this.formData.quantity,sale_rate:this.formData.sale_rate,batch_no:this.formData.batch_no,discount:this.formData.discount?this.formData.discount:0,discount_percent:this.formData.discount_percent?this.formData.discount_percent:0,total_rate:this.formData.total_rate,desc:this.formData.desc,manual_no:this.formData.manual_no,vendor_id:this.formData.vendor_id,product_id:this.formData.product_id}),this.formData.total_quantity=this.addedItems.reduce((l,t)=>l+parseInt(t.quantity),0),this.formData.net_amount=this.addedItems.reduce((l,t)=>l+parseFloat(t.total_rate),0),this.formData.total=this.addedItems.reduce((l,t)=>l+parseFloat(t.total_rate),0),this.formData.total_discount=this.addedItems.reduce((l,t)=>l+parseInt(t.discount),0),this.formData.total_items=this.addedItems.length,this.formData.product_code="",this.formData.product_id="",this.formData.quantity="",this.formData.purchase_rate="",this.formData.batch_no="",this.formData.discount=void 0,this.formData.vendor_address="",this.formData.vendor_code="",this.formData.discount_percent=void 0,this.formData.vendor_id="",this.formData.total_rate="",this.formData.desc="",this.formData.manual_no=""},removeItem(l){this.addedItems.splice(l,1),this.formData.total_quantity=this.addedItems.reduce((t,r)=>t+parseInt(r.quantity),0),this.formData.net_amount=this.addedItems.reduce((t,r)=>t+parseFloat(r.total_rate),0),this.formData.total=this.addedItems.reduce((t,r)=>t+parseFloat(r.total_rate),0),this.formData.total_discount=this.addedItems.reduce((t,r)=>t+parseInt(r.discount),0),this.formData.total_items=this.addedItems.length},getProductById(l){const t=this.products.find(r=>r.id===l);return t?t.text:""}}},S={style:{"font-size":"20px"}},U=e("br",null,null,-1),L={class:"flex space-x-4"},N={class:"w-1/6"},T={class:"text-rose-500"},E={class:"flex space-x-4"},R={class:"w-1/6"},K={class:"w-1/6"},H={class:"w-1/6"},Q={class:"w-1/6"},j={class:"w-1/6"},z={class:"w-1/6"},O={class:"w-1/6"},W={class:"overflow-hidden mb-8 w-full rounded-lg border shadow-xs"},M={class:"overflow-x-auto w-full"},Z={class:"w-full whitespace-no-wrap"},G=e("thead",null,[e("tr",{class:"text-xs font-semibold tracking-wide text-left text-gray-500 uppercase bg-gray-50 border-b"},[e("th",{class:"px-4 py-3"},"Sr"),e("th",{class:"px-4 py-3"},"Product Code"),e("th",{class:"px-4 py-3"},"Product Name"),e("th",{class:"px-4 py-3"},"Qty"),e("th",{class:"px-4 py-3"},"Rate"),e("th",{class:"px-4 py-3"},"Action")])],-1),J={class:"bg-white divide-y"},X={class:"px-4 py-3 text-sm"},Y={class:"px-4 py-3 text-sm"},$={class:"px-4 py-3 text-sm"},tt={class:"px-4 py-3 text-sm"},et={class:"px-4 py-3 text-sm"},at={class:"px-4 py-3 text-sm"},ot=["onClick"],st=e("br",null,null,-1),lt={class:"flex space-x-4"},rt={class:"w-1/6"},it={class:"w-1/6"},dt={class:"w-1/6"},nt={class:"w-1/6"},ut={class:"w-1/6"},mt={class:"w-1/6"},ct={class:"w-1/6"},_t={class:"w-1/6"},pt=e("br",null,null,-1),ft={class:"w-1/6"};function ht(l,t,r,yt,s,n){const v=m("Head"),i=m("InputLabel"),d=m("TextInput"),x=m("Select2Input"),y=m("PrimaryButton"),b=m("AuthenticatedLayout");return f(),h(D,null,[o(v,{title:"Sale Invoice"}),o(b,null,{header:c(()=>[_(" Edit Sale Invoice-"+u(r.saleInvoice.id),1)]),default:c(()=>[e("div",null,[e("form",{onSubmit:t[20]||(t[20]=C((...a)=>n.submitForm&&n.submitForm(...a),["prevent"])),class:"mt-2 space-y-2"},[e("b",S," INV-"+u(r.sr+1),1),U,e("div",L,[e("div",N,[e("h1",T,[_("Remaining "),e("span",null,u(s.formData.remaining_stock),1)])])]),e("div",E,[e("div",R,[o(i,{for:"product_code",value:"Product Code"}),o(d,{onChange:t[0]||(t[0]=a=>n.getProductDetails(s.formData.product_code)),id:"product_code",ref:"product_code",modelValue:s.formData.product_code,"onUpdate:modelValue":t[1]||(t[1]=a=>s.formData.product_code=a),type:"text",class:"mt-1 block w-full",autocomplete:"product_code",readonly:""},null,8,["modelValue"])]),e("div",K,[o(i,{for:"product",value:"Product Name"}),o(x,{options:r.products,onChange:t[2]||(t[2]=a=>n.getProductDetails(a)),modelValue:s.formData.product_id,"onUpdate:modelValue":t[3]||(t[3]=a=>s.formData.product_id=a),style:{width:"-webkit-fill-available",height:"40px !important","margin-top":"5px"}},null,8,["options","modelValue"])]),e("div",H,[o(i,{for:"quantity",value:"Quantity"}),o(d,{id:"quantity",ref:"quantity",modelValue:s.formData.quantity,"onUpdate:modelValue":t[4]||(t[4]=a=>s.formData.quantity=a),type:"text",class:"mt-1 block w-full",autocomplete:"quantity",onKeyup:n.quantityWisePrice},null,8,["modelValue","onKeyup"])]),e("div",Q,[o(i,{for:"sale_rate",value:"Sale Rate"}),o(d,{id:"sale_rate",ref:"sale_rate",modelValue:s.formData.sale_rate,"onUpdate:modelValue":t[5]||(t[5]=a=>s.formData.sale_rate=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"sale_rate"},null,8,["modelValue"])]),e("div",j,[o(i,{for:"total_rate",value:"Amount"}),o(d,{id:"total_rate",ref:"total_rate",modelValue:s.formData.total_rate,"onUpdate:modelValue":t[6]||(t[6]=a=>s.formData.total_rate=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"total_rate",readonly:""},null,8,["modelValue"])]),e("div",z,[o(i,{for:"expiry_date",value:"Expiry Date"}),o(d,{id:"expiry_date",ref:"expiry_date",modelValue:s.formData.expiry_date,"onUpdate:modelValue":t[7]||(t[7]=a=>s.formData.expiry_date=a),type:"date",readonly:"",class:"mt-1 block w-full",autocomplete:"expiry_date"},null,8,["modelValue"])]),e("div",O,[o(i,{for:"expiry_alert_days",value:"Expiry Alert Days"}),o(d,{id:"expiry_alert_days",ref:"expiry_alert_days",modelValue:s.formData.expiry_alert_days,"onUpdate:modelValue":t[8]||(t[8]=a=>s.formData.expiry_alert_days=a),type:"number",readonly:"",class:"mt-1 block w-full",autocomplete:"expiry_alert_days"},null,8,["modelValue"])])]),e("button",{type:"button",onClick:t[9]||(t[9]=(...a)=>n.addItem&&n.addItem(...a)),class:"rounded-lg border border-transparent bg-purple-600 px-4 py-2 text-center text-sm font-medium leading-5 text-white transition-colors duration-150 hover:bg-purple-700 focus:outline-none focus:ring active:bg-purple-600"},"Add"),e("div",W,[e("div",M,[e("table",Z,[G,e("tbody",J,[(f(!0),h(D,null,A(r.saleInvoice.sale_invoice_detail,(a,p)=>(f(),h("tr",{class:"text-gray-700",key:p},[e("td",X,u(p+1),1),e("td",Y,u(a.product.id),1),e("td",$,u(a.product.name),1),e("td",tt,u(a.quantity),1),e("td",et,u(a.amount),1),e("td",at,[e("button",{type:"button",onClick:Dt=>n.editItem(p)},"Edit",8,ot)])]))),128))])])])]),st,e("div",lt,[e("div",rt,[o(i,{for:"total_items",value:"Total Items"}),o(d,{id:"total_items",ref:"total_items",modelValue:s.formData.total_items,"onUpdate:modelValue":t[10]||(t[10]=a=>s.formData.total_items=a),type:"number",class:"mt-1 block w-full",autocomplete:"total_items",readonly:""},null,8,["modelValue"])]),e("div",it,[o(i,{for:"total_quantity",value:"Total Quantity"}),o(d,{id:"total_quantity",ref:"total_quantity",modelValue:s.formData.total_quantity,"onUpdate:modelValue":t[11]||(t[11]=a=>s.formData.total_quantity=a),type:"number",class:"mt-1 block w-full",autocomplete:"total_quantity",readonly:""},null,8,["modelValue"])]),e("div",dt,[o(i,{for:"net_amount",value:"Net Amount"}),o(d,{id:"net_amount",ref:"net_amount",modelValue:s.formData.net_amount,"onUpdate:modelValue":t[12]||(t[12]=a=>s.formData.net_amount=a),type:"number",step:"0.01",class:"mt-1 block w-full",readonly:"",autocomplete:"net_amount"},null,8,["modelValue"])]),e("div",nt,[o(i,{for:"service_charges",value:"Service Chares"}),o(d,{id:"service_charges",ref:"service_charges",modelValue:s.formData.service_charges,"onUpdate:modelValue":t[13]||(t[13]=a=>s.formData.service_charges=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"service_charges",onChange:n.calculateNetAmount},null,8,["modelValue","onChange"])]),e("div",ut,[o(i,{for:"total_discount",value:"Total Discount"}),o(d,{id:"total_discount",ref:"total_discount",modelValue:s.formData.total_discount,"onUpdate:modelValue":t[14]||(t[14]=a=>s.formData.total_discount=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"total_discount",onChange:n.calculateTotalDiscount},null,8,["modelValue","onChange"])]),e("div",mt,[o(i,{for:"total",value:"Total Amount"}),o(d,{id:"total",ref:"total",modelValue:s.formData.total,"onUpdate:modelValue":t[15]||(t[15]=a=>s.formData.total=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"total",readonly:""},null,8,["modelValue"])]),e("div",ct,[o(i,{for:"received_amount",value:"Received Amount"}),o(d,{id:"received_amount",ref:"received_amount",modelValue:s.formData.received_amount,"onUpdate:modelValue":t[16]||(t[16]=a=>s.formData.received_amount=a),type:"number",step:"0.01",class:F(["mt-1 block w-full",{"border-red-500":s.isAmountLess}]),autocomplete:"received_amount",onKeyup:n.receivedAndBalance,required:""},null,8,["modelValue","class","onKeyup"])]),e("div",_t,[o(i,{for:"remaining_balance",value:"Remaining Balance"}),o(d,{id:"remaining_balance",ref:"remaining_balance",modelValue:s.formData.remaining_balance,"onUpdate:modelValue":t[17]||(t[17]=a=>s.formData.remaining_balance=a),type:"number",step:"0.01",class:"mt-1 block w-full",autocomplete:"remaining_balance",readonly:""},null,8,["modelValue"])])]),pt,e("div",ft,[o(y,{onClick:t[18]||(t[18]=a=>n.handleButtonClick("save"))},{default:c(()=>[_("Save")]),_:1}),o(y,{class:"ml-1",onClick:t[19]||(t[19]=a=>n.handleButtonClick("saveandprint"))},{default:c(()=>[_("Save & Print")]),_:1})])],32)])]),_:1})],64)}const wt=B(P,[["render",ht]]);export{wt as default};
